{
    "AWSTemplateFormatVersion": "2010-09-09",
        "Description": "",
        "Parameters": {
            "SMname": {
                "Type": "String",
                "Default" : "DefaultSecretManager"
            },
            "s3BucketARN": {
                "Type": "String",
                "Default": "arn:aws:s3:::aws-testengine-s3"
            }
        },
        "Resources": {
            "S3IamRole" : {
                "Type" : "AWS::IAM::Role",
                "Properties" : {
                    "RoleName" : "S3-Bucket-Role",
                    "AssumeRolePolicyDocument" : {
                        "Version": "2012-10-17",
                        "Statement": [
                            {
                                "Effect": "Allow",
                                "Principal": {
                                    "Service": [
                                        "s3.amazonaws.com"
                                    ]
                                },
                                "Action": "sts:AssumeRole"
                            }
                        ]
                    },
                    "Path": "/",
                    "Description" : "S3 Bucket IAM Role",
                    "Policies": [
                        {
                            "PolicyName": "S3-Bucket-Policy",
                            "PolicyDocument": {
                                "Version": "2012-10-17",
                                "Statement": [
                                    {
                                        "Effect": "Allow",
                                        "Action": [
                                            "s3:GetObject",
                                            "s3:PutObject",
                                            "s3:ListBucket",
                                            "s3:DeleteObject"
                                        ],
                                        "Resource": {"Ref" : "s3BucketARN"}
                                    }
                                ]
                            }
                        }
                    ]
                }
            },
            "SMIamRole" : {
                "Type" : "AWS::IAM::Role",
                "Properties" : {
                    "RoleName" : "Secret-Manager-Role",
                    "AssumeRolePolicyDocument" : {
                        "Version": "2012-10-17",
                        "Statement": [
                            {
                                "Effect": "Allow",
                                "Principal": {
                                    "Service": [
                                        "secretsmanager.amazonaws.com"
                                    ]
                                },
                                "Action": "sts:AssumeRole"
                            }
                        ]
                    },
                    "Path": "/",
                    "Description" : "Secret Manager IAM Role",
                    "Policies": [
                        {
                            "PolicyName": "Secret-Manager-Policy",
                            "PolicyDocument": {
                                "Version": "2012-10-17",
                                "Statement": [
                                    {
                                        "Effect": "Allow",
                                        "Action": [
                                            "secretsmanager:GetSecretValue",
                                            "secretsmanager:DescribeSecret",
                                            "secretsmanager:ListSecrets"
                                        ],
                                        "Resource": {"Ref" : "SecretManager"}
                                    }
                                ]
                            }
                        }
                    ]
                }
            },
            "SecretManager": {
                "Type": "AWS::SecretsManager::Secret",
                "Properties": {
                  "Name": {"Ref" : "SMname"},
                  "Description": "This secret has a hardcoded password in SecretString (use GenerateSecretString instead)",
                  "SecretString": "{\"username\":\"MasterUsername\",\"password\":\"secret-password\"}",
                  "Tags": [
                    {
                      "Key": "AppName",
                      "Value": "App"
                    }
                  ]
                }
              }
        },
        "Outputs": {
    
        }
    }